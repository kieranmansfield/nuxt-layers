/**
 * Swiss Grid System - CSS Utilities
 *
 * Inspired by Josef Müller-Brockmann's grid systems.
 * Uses CSS subgrid for precise alignment across layout hierarchy.
 *
 * Hierarchy:
 *   MastMain (mastmain utility)
 *   └── BaseSection (basesection utility, uses subgrid)
 *       └── BaseGridItem (positioned via inline grid-column/grid-row)
 */

/**
 * mastmain - Root grid container with responsive density
 *
 * Creates responsive grid:
 * - Mobile: 6 columns (default)
 * - Tablet: 12 columns (≥ 48rem / 768px)
 * - Desktop: 18 columns (≥ 80rem / 1280px)
 *
 * Each row height is calculated to fit 12 rows per viewport.
 */
@utility mastmain {
  --grid-cols: 6;
  --grid-rows-per-section: 12;
  --grid-gap: clamp(0.75rem, 1.5vw, 1.5rem);
  --grid-padding: clamp(1rem, 2.5vw, 2rem); /* Outer gutters: 16px to 32px */
  --section-height: 100vh;
  --grid-row-height: calc(
    (var(--section-height) - (var(--grid-rows-per-section) - 1) * var(--grid-gap)) /
      var(--grid-rows-per-section)
  );

  display: grid;
  grid-template-columns: repeat(var(--grid-cols), 1fr);
  grid-auto-rows: var(--grid-row-height);
  gap: var(--grid-gap);
  padding-inline: var(--grid-padding); /* Outer gutters on left/right */
  overflow-x: hidden;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;

  /* On mobile, allow rows to grow with content */
  @media (width < 48rem) {
    grid-auto-rows: minmax(var(--grid-row-height), auto);
  }

  /* Tablet: 12 columns */
  @media (width >= 48rem) {
    :root {
      --grid-cols: 12;
    }
  }

  /* Desktop: 18 columns */
  @media (width >= 80rem) {
    :root {
      --grid-cols: 18;
    }
  }
}

/**
 * basesection - Full-viewport section using subgrid
 *
 * Inherits parent's grid lines via subgrid.
 * Spans 12 rows (1 viewport height).
 */
@utility basesection {
  container-type: inline-size;
  container-name: section;
  grid-column: 1 / -1;
  grid-row: span var(--grid-rows-per-section, 12);
  display: grid;
  grid-template-columns: subgrid;
  grid-template-rows: subgrid;
  scroll-snap-align: start;
  max-width: 100%;
  width: 100%;
  box-sizing: border-box;

  /* Ensure all direct children respect container width */
  & > * {
    max-width: 100%;
    min-width: 0;
    box-sizing: border-box;
    overflow-wrap: break-word;
    word-wrap: break-word;
  }

  /* On mobile, allow sections to grow beyond 12 rows if needed */
  @media (width < 48rem) {
    grid-row: auto;
    min-height: 100vh;
  }
}

/**
 * Baseline Grid / Vertical Rhythm Utilities
 *
 * Maintains consistent vertical spacing based on a configurable baseline unit.
 * Default rhythm unit: 0.25rem (4px)
 */

/* Line height utilities */
@utility leading-rhythm-4 {
  --rhythm: 0.25rem;
  line-height: calc(var(--rhythm) * 4); /* 1rem */
}

@utility leading-rhythm-5 {
  --rhythm: 0.25rem;
  line-height: calc(var(--rhythm) * 5); /* 1.25rem */
}

@utility leading-rhythm-6 {
  --rhythm: 0.25rem;
  line-height: calc(var(--rhythm) * 6); /* 1.5rem */
}

@utility leading-rhythm-7 {
  --rhythm: 0.25rem;
  line-height: calc(var(--rhythm) * 7); /* 1.75rem */
}

@utility leading-rhythm-8 {
  --rhythm: 0.25rem;
  line-height: calc(var(--rhythm) * 8); /* 2rem */
}

/* Vertical spacing utilities */
@utility space-rhythm-1 {
  --rhythm: 0.25rem;
  margin-block: var(--rhythm); /* 0.25rem */
}

@utility space-rhythm-2 {
  --rhythm: 0.25rem;
  margin-block: calc(var(--rhythm) * 2); /* 0.5rem */
}

@utility space-rhythm-4 {
  --rhythm: 0.25rem;
  margin-block: calc(var(--rhythm) * 4); /* 1rem */
}

@utility space-rhythm-6 {
  --rhythm: 0.25rem;
  margin-block: calc(var(--rhythm) * 6); /* 1.5rem */
}

@utility space-rhythm-8 {
  --rhythm: 0.25rem;
  margin-block: calc(var(--rhythm) * 8); /* 2rem */
}

/* Prose container - auto-applies rhythm to children */
@utility prose-rhythm {
  --rhythm: 0.25rem;

  & > * + * {
    margin-block-start: calc(var(--rhythm) * 4); /* 1rem between elements */
  }

  & > h1,
  & > h2,
  & > h3,
  & > h4,
  & > h5,
  & > h6 {
    margin-block-start: calc(var(--rhythm) * 8); /* 2rem before headings */
    margin-block-end: calc(var(--rhythm) * 4); /* 1rem after headings */
    line-height: calc(var(--rhythm) * 8);
  }

  & > p {
    line-height: calc(var(--rhythm) * 6); /* 1.5rem for paragraphs */
  }
}
